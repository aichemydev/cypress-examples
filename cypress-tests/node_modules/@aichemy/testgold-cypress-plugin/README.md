This is the [TestGold](https://testgold.dev) plugin for
[Cypress](https://www.cypress.io/). It enables auto-healing of failed selectors.

## How to use the TestGold Cypress plugin

1. Install the [TestGold Cypress plugin
   package](https://www.npmjs.com/package/@aichemy/testgold-cypress-plugin) with
   NPM or yarn: `@aichemy/testgold-cypress-plugin`.

2. Add the required config object to your `cypress.json` file:

   ```
   {...,
     "testGold": {
       "serverTimeout": 180.0,
       "handleFailure": "suggest-xpaths",
       "filterEnabled": false,
       "filterDisplayed": false,
       "neighborMaxDist": -1,
       "fastHeal": false,
       "imageComparison": false
     }...
   }
   ```

   It's a good idea to set the value of `"defaultCommandTimeout"` in the
   cypress.json file to something like 180000 (180 seconds) to allow waiting for
   heal responses.

3. Update the `cypress/support/index.ts` or `cypress/support/index.js` file in
   your tests' repo to include an import of the
   `@aichemy/testgold-cypress-plugin`:

   ```javascript
   import '@aichemy/testgold-cypress-plugin'
   ```

   if it's a `.ts` file or a `.js` file. Alternatively, use:

   ```javascript
   require('@aichemy/testgold-cypress-plugin')
   ```

   for a `.js` file if you want.

4. Update the `cypress/plugins/index.ts` or `cypress/plugins/index.js` file in
   your tests' repo to include an import of the `testgold-cypress-plugin`'s
   screenshot hook:

   ```javascript
   const { addScreenshotHook } = require(
     '@aichemy/testgold-cypress-plugin/src/tgScreenshotHook'
   )

   module.exports = (on, config) => {
     // `on` is used to hook into various events Cypress emits
     // `config` is the resolved Cypress config
     addScreenshotHook(on, config)
   }
   ```

5. Export the required environment variables before starting Cypress:

   ```bash
   export CYPRESS_TG_ENABLED=true
   export CYPRESS_TG_TOKEN='your TestGold AIO token'
   ```

6. Start Cypress from your repo and run your tests:

   ```bash
   ./node_modules/cypress/bin/cypress open
   ```

## Changelog

### 1.2.1 - 2021-02-26

#### Fixes

- Correct parsing of the values of TG_TOKEN and TG_ENABLED from the Cypress env object

### 1.2.0 - 2021-02-25

#### Changes

- Screenshots are now taken in the "runner" mode as opposed to "viewport" in
  1.1.x.

### 1.1.19 - 2021-02-24

Initial complete NPM release.

### 1.1.18 - 2021-02-24

Testing NPM release.

